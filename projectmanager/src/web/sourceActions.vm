<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
#load("project/resources")
#load_core_resources
	<title>#i18n("workspace.title") - DataLift</title>
#css_links
#header_links
#script_links

</head>
<body ng-app="module" ng-controller="moduleController">
#h_tetiere
<!-- ---------------- SOURCE SPACE -------------------- -->
<div class="container-fluid" id="projectSpaceContainer">
	<div class="span12 row-fluid">
		<h3 class="text-center" id="sourceName">$curSource.title</h3>
		<span id="gangway"></span>
		<div class="row-fluid" style="margin-top: 20px;">
			<!-- DIV HISTOIRIQUE -->
			<div class="span3 border3">
				<h4 class="pagination-centered">#i18n("records")</h4>
				<div class="span12" style="border: solid #808080 1px; height: 500px">
					<!-- RSS FEED -->
					<div id="rss_feed" class="history-list" style="padding: 5px; color: #909090; font-size : .7em;"></div>
					<!-- FIN RSS FEED -->
				</div>
			</div>
			<!-- FIN DIV HISTOIRIQUE -->
			<!-- DIV CONTENT TAB ONGLET CONTAINER -->
			<div class="span9">
				<!-- LISTE ONGLET -->
				<ul class="nav nav-tabs" id="tab_details">
					<li><a href="#consultation">#i18n("action.tab.consult")</a></li>
					<li class="active"><a href="#actions">#i18n("action.tab")</a></li>
					<li><a href="#modify">#i18n("Modifier")</a></li>
				</ul>
				<!-- FIN LISTE ONGLET -->
				<!-- DIV CONTENT TAB ONGLETS -->
				<div class="tab-content" id="tab-sub-menu-action" ng-init='#foreach ($mod in $canHandle) initialize("$mod.getLabel()", "$mod.getMethod()", "$mod.getPosition()", "$mod.getUri()"); #end'>
					<!-- ONGLET ACTIONS -->
				  	<div class="tab-pane active" id="actions">
				  		<div class="alerts span10" id="alert-ban" style="display:none;">
					  		<div class="alert-message success">
					  			<a class="close" href="#" data-dismiss="alert">Ã—</a>
					  			<p><strong>Well done!</strong> you have just convert a csv file into an rdf</p>
					  		</div>
					  	</div>		  	
					  	<div class="span12">
				  			<h5>1. #i18n("action.module.convert")</h5>
				  			<select id="moduleLevel1" ng-model="moduleLevel1" ng-options="m.label for m in modulesLevel1"></select>
				  			<a href="#" data-dismiss="modal" class="btn" style="display:inline-block" ng-click="moduleRedirectL1('${baseUri}')">#i18n("action.button.convert")</a>
			  			</div>
			  			
			  			<div class="span12">
				  			<h5>2. #i18n("action.module.publication")</h5>
				  			<select id="moduleLevel2" ng-model="moduleLevel2" ng-options="m.label for m in modulesLevel2"></select>
				  			<a href="#" data-dismiss="modal" class="btn" style="display:inline-block" ng-click="moduleRedirectL2('${baseUri}')">#i18n("action.button.publication")</a>
			  			</div>
			  			
			  			<div class="span12">
				  			<h5>3. #i18n("action.module.interconnect")</h5>
				  			<select id="moduleLevel3" ng-model="moduleLevel3" ng-options="m.label for m in modulesLevel3"></select>
				  			<a href="#" data-dismiss="modal" class="btn" style="display:inline-block" ng-click="moduleRedirectL3('${baseUri}')">#i18n("action.button.interconnect")</a>
			  			</div>
			  			
			  			<div class="span12">
				  			<h5>4. #i18n("action.module.exploit")</h5>
				  			<select id="moduleLevel4" ng-model="moduleLevel4" ng-options="m.label for m in modulesLevel4"></select>
				  			<a href="#" data-dismiss="modal" class="btn" style="display:inline-block" ng-click="moduleRedirectL1L4('${baseUri}')">#i18n("action.button.exploit")</a>
			  			</div>

			  		</div><!-- FIN ONGLET ACTIONS -->

				  	<!-- ONGLET CONSULTATION -->
				  	<div class="tab-pane" id="consultation">
				  		<div class="span12 row" style="margin:0 auto; float:none;">
				  			<p>Ici l'utilisateur pourra consulter la source</p>
						</div>
				  	</div>
				  	<!-- FIN ONGLET CONSULTATION -->
				  	<!-- ONGLET MODIFIY -->
					<div class="tab-pane" id="modify">
						<p>Ici se trouvera l'espace de modification de la source.</p>
					</div>
					<!-- FIN ONGLET MODIFY -->
		  		</div><!-- FIN DIV CONTENT TAB ONGLETS -->
			 </div> 	
		</div><!-- FIN DIV CONTENT TAB ONGLETS CONTAINER -->
	</div>
</div>
</div> <!-- ---------------- FIN PROJECT SPACE -------------------- -->

#h_footer
<script type="text/javascript">
$(document).ready(function() {
	var hostLane = window.location.protocol + "//" + window.location.host + window.location.pathname;
	var pathArray = window.location.pathname.split( '/' );
	var searchLane = window.location.search;
	var pathLane = '<a href="' + window.location.protocol + "//" + window.location.host + "/" + pathArray[1] + '">' + pathArray[1] + ' >> </a>';
	pathLane += '<a href="' + window.location.protocol + "//" + window.location.host + "/" + pathArray[1] + "/" + pathArray[2] + '">' + pathArray[2] + ' >> </a>';
	pathLane += '<a href="' + hostLane + window.location.search + '">' + searchLane.substr(searchLane.lastIndexOf('=') + 1) + ' >> </a>';
	console.log(pathLane);
	console.log(window.location.search);
	jQuery('#gangway').append(pathLane);
	
	//flux rss parsing function
	jQuery(function() {
	    jQuery.getFeed({
	    	//url = url to catch le flux
	        url: "$curSource.uri"+'/feed',
	        success: function(feed) {
	            jQuery('#rss_feed').append('<span style="font-size: 1.5em; color: 808080;" class="pagination-centered">'
	            + feed.title
	            + '</span>');
	            
	            var html = '';   
	            for(var i = 0; i < feed.items.length && i < 5; i++) {
	                var item = feed.items[i];
	                var update = new Date(item.updated);
	                
	                html += '</br></br><span style="color: #BE188A;">'
	                		+ item.title
	                		+ '</span>';
	                html += '<div class="updated"><span>'
                			+ update.toString()
                			+'</span</div>';
	            }
	            
	            jQuery('#rss_feed').append(html);
	        }    
	    });
	});
});
</script>
</body>
</html>